<?xml version="1.0" encoding="UTF-8"?>
<workflow name="generic">
  <action-set name="start" next-action-set="quarantine" error-action-set="end"> </action-set>

  <action-set name="quarantine" next-action-set="preservation" error-action-set="error">
  	
  	<file-ops name="copy">
  	  <actionOption>COPY</actionOption>
  	  <source>C:\Nott\workflowdemo\inbox\StateRobotNSW\TheTransferOfJedi</source>
  	  <target>C:\Nott\workflowdemo\quarantine\StateRobotNSW\TheTransferOfJedi</target>
  	</file-ops>
  	
    <sleep name="1-min-quarantine">
      <minute>1</minute>
      <hour>0</hour>
      <day>0</day>
    </sleep>
    
    <virus-scan name="virus-check">
	   <path>C:\Nott\workflowdemo\quarantine\StateRobotNSW\TheTransferOfJedi</path>
  	</virus-scan>
  	
  	<mail-notification name="system-alert">
  	 <target>wisanu.promthong@records.nsw.gov.au</target>
  	 <message>the file are quarantined</message>
  	</mail-notification>
  	
  </action-set>
  
   <action-set name="preservation" next-action-set="repository" error-action-set="error">
    <file-ops name="copy">
  	  <source>C:\Nott\workflowdemo\quarantine\StateRobotNSW\TheTransferOfJedi</source>
  	  <target>C:\Nott\workflowdemo\staging\StateRobotNSW\TheTransferOfJedi</target>
  	</file-ops>
	<normalisation name="doc_to_pdf">
	  <pathways>
	    <string>http://localhost:8080/pathways/1</string>
	    <string>http://localhost:8080/pathways/2</string>
      </pathways>
	</normalisation>
	<normalisation name="binary">
 	  <pathways>
	    <string>http://localhost:8080/pathways/1</string>
      </pathways>
	</normalisation>
  </action-set>
  
  <action-set name="repository" next-action-set="cleanup" error-action-set="error" >
    <repository name="repository-deposit">
  		<source>C:\Nott\workflowdemo\staging\StateRobotNSW\TheTransferOfJedi</source>
  	</repository>
  	
  	<mail-notification name="system-alert">
  	 <target>wisanu.promthong@records.nsw.gov.au</target>
  	 <message>the records are stored in the repository</message>
  	</mail-notification>
  	
  </action-set>
  
  <action-set name="cleanup" next-action-set="end" error-action-set="error">
  	
  	<file-ops name="delete_inbox">
  	  <source>C:\Nott\workflowdemo\inbox\StateRobotNSW\TheTransferOfJedi</source>
  	</file-ops>
  	
  	<file-ops name="delete_quarantine">
  	  <source>C:\Nott\workflowdemo\quarantine\StateRobotNSW\TheTransferOfJedi</source>
  	</file-ops>
    
  	<file-ops name="delete_preservation">
  	  <source>C:\Nott\workflowdemo\staging\StateRobotNSW\TheTransferOfJedi</source>
  	</file-ops>

  </action-set>
  
  <action-set name="error" next-action-set="end" error-action-set="end" >  	
  	<mail-notification name="system-error">
  	 <target>wisanu.promthong@records.nsw.gov.au</target>
  	 <message>system malfunction detected</message>
  	</mail-notification>
  </action-set>
  
</workflow>